{{ $dyn := include "_dynamic/dyn_config.json" | mustFromJson -}}
#!{{ lookPath "sh" }}

userresources=$HOME/.Xresources
usermodmap=$HOME/.Xmodmap
sysresources=/usr/local/etc/X11/xinit/.Xresources
sysmodmap=/usr/local/etc/X11/xinit/.Xmodmap


# XDG Base Directories
# user-specific data files
XDG_DATA_HOME=$HOME/.local/share; export XDG_DATA_HOME
# user-specific configuration files
XDG_CONFIG_HOME=$HOME/.config; export XDG_CONFIG_HOME
# user-specific state data files
XDG_STATE_HOME=$HOME/.local/state; export XDG_STATE_HOME
# user-specific executable files (defined in /etc/login.conf)
# $HOME/.local/bin
# search path for data files in addition to XDG_DATA_HOME
XDG_DATA_DIRS=/usr/local/share/:/usr/share/; export XDG_DATA_DIRS
# search path for config files in addition to XDG_CONFIG_HOME
XDG_CONFIG_DIRS=/usr/local/etc/xdg; export XDG_CONFIG_DIRS
# user-specific non-essential data files
XDG_CACHE_HOME=$HOME/.cache; export XDG_CACHE_HOME
# user-specific non-essential runtime files (sockets, named pipes, â€¦)
XDG_RUNTIME_DIR=$(mktemp -dt X-runtime-$UID); export XDG_RUNTIME_DIR

# merge in defaults and keymaps

if [ -f $sysresources ]; then
    xrdb -merge $sysresources
fi

if [ -f $sysmodmap ]; then
    xmodmap $sysmodmap
fi

if [ -f "$userresources" ]; then
    xrdb -merge "$userresources"
fi

if [ -f "$usermodmap" ]; then
    xmodmap "$usermodmap"
fi

# start some nice programs
if [ -d /usr/local/etc/X11/xinit/xinitrc.d ] ; then
    for f in /usr/local/etc/X11/xinit/xinitrc.d/?*.sh ; do
        [ -x "$f" ] && . "$f"
    done
    unset f
fi

# set colemak keyboard layout
setxkbmap -model pc105 -layout us -variant colemak_dh {{ $dyn.keyboard_options }}
xset r rate 250 30

# disable power saving
xset -dpms

# set screen positions
xrandr --output DP-1 --primary --mode 3440x1440 --above HDMI-2

# start window manager
exec leftwm

